<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ARM Gallery - Mesa Main Street Stations | Mecom</title>
    <script src="loader.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html, body {
        font-family: "DM Sans", sans-serif;
        background-color: #000;
        overflow: hidden;
        height: 100vh;
        height: calc(var(--vh, 1vh) * 100);
        width: 100vw;
        margin: 0;
        padding: 0;
        /* Performance optimizations */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
        /* Hardware acceleration */
        transform: translateZ(0);
        backface-visibility: hidden;
        perspective: 1000px;
      }

      .navigation-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100px;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(10px);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .nav-arrow {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
      }

      .nav-arrow:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .nav-arrow svg {
        width: 24px;
        height: 24px;
      }

      .nav-thumbnails {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .thumbnail {
        width: 50px;
        height: 50px;
        border-radius: 8px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
      }

      .thumbnail:hover {
        transform: scale(1.1);
        border-color: rgba(255, 255, 255, 0.3);
      }

      .thumbnail.active {
        border-color: #fff;
        transform: scale(1.1);
      }

      .thumbnail img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        max-width: 1920px;
        max-height: 1080px;
      }

      .slider {
        position: fixed;
        top: 100px;
        left: 0;
        width: 100vw;
        height: calc(100vh - 100px);
        height: calc(calc(var(--vh, 1vh) * 100) - 100px);
        background-color: #000;
        overflow: hidden;
      }

      .slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        will-change: transform, opacity;
        /* Hardware acceleration for smoother animations */
        transform: translateZ(0);
        backface-visibility: hidden;
        /* Optimize for animations */
        contain: layout style paint;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .slide-img {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #000;
      }

      .slide img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        object-position: center;
        display: block;
        background-color: #000;
      }

      .slide-title {
        position: absolute;
        top: 4rem;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        color: white;
        z-index: 100;
        max-width: 80%;
      }

      .slide-tags {
        position: absolute;
        bottom: 4rem;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        color: white;
        z-index: 100;
        max-width: 80%;
        margin-top: 0;
      }

      .slide-title h1 {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        font-family: "DM Sans", sans-serif;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      .slide-description p {
        font-size: 1.2rem;
        line-height: 1.6;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      }

      .slide-tags {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .slide-tags p {
        background: rgba(255, 255, 255, 0.1);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin: 0;
        transition: all 0.3s ease;
        opacity: 0;
        transform: translateY(20px);
        animation: slideInUp 0.6s ease forwards;
      }

      .slide-tags p:nth-child(1) {
        animation-delay: 0.2s;
        order: 1;
      }

      .slide-tags p:nth-child(2) {
        animation-delay: 0.4s;
        order: 2;
        background: rgba(255, 255, 255, 0.15);
        font-weight: 600;
      }

      .slide-tags p:nth-child(3) {
        animation-delay: 0.6s;
        order: 3;
      }

      @keyframes slideInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .line,
      .word {
        position: relative;
        display: inline-block;
        will-change: transform;
        /* Optimize text animations */
        transform: translateZ(0);
        backface-visibility: hidden;
      }

      /* Back to Commercial Button */
      .back-button {
        position: fixed;
        top: 100px;
        left: 2rem;
        z-index: 1001;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        border: 2px solid #fff;
        border-radius: 8px;
        padding: 0.8rem 1.5rem;
        color: #fff;
        text-decoration: none;
        font-family: "DM Mono", monospace;
        font-size: 0.9rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: -0.01rem;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .back-button:hover {
        background: #fff;
        color: #000;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
      }

      .back-button svg {
        width: 16px;
        height: 16px;
        transition: transform 0.3s ease;
      }

      .back-button:hover svg {
        transform: translateX(-3px);
      }

      /* Image Counter */
      .image-counter {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        z-index: 1001;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        border: 2px solid #fff;
        border-radius: 8px;
        padding: 0.8rem 1.5rem;
        color: #fff;
        font-family: "DM Mono", monospace;
        font-size: 0.9rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: -0.01rem;
        transition: all 0.3s ease;
      }

      /* Mobile Responsive */
      @media (max-width: 1000px) {
        .navigation-bar {
          height: 80px;
          padding: 0 1rem;
        }

        .slider {
          top: 80px;
          height: calc(100vh - 80px);
          height: calc(calc(var(--vh, 1vh) * 100) - 80px);
        }

        .slide {
          height: 100%;
        }

        .nav-arrow {
          width: 40px;
          height: 40px;
        }

        .nav-arrow svg {
          width: 20px;
          height: 20px;
        }

        .thumbnail {
          width: 40px;
          height: 40px;
        }

        .nav-thumbnails {
          gap: 0.5rem;
        }

        .slide-title h1 {
          font-size: 2rem;
        }

        .slide-description p {
          font-size: 1rem;
        }

        .slide-title {
          top: 3rem;
          max-width: 90%;
        }

        .slide-tags {
          bottom: 3rem;
          max-width: 90%;
        }

        .slide-tags {
          flex-direction: row;
          justify-content: center;
          align-items: center;
          gap: 0.8rem;
        }

        .slide-tags p {
          font-size: 0.8rem;
          padding: 0.4rem 0.8rem;
        }

        .back-button {
          top: 80px;
          left: 1rem;
          padding: 0.6rem 1rem;
          font-size: 0.8rem;
        }

        .back-button svg {
          width: 14px;
          height: 14px;
        }

        .image-counter {
          bottom: 1rem;
          right: 1rem;
          padding: 0.6rem 1rem;
          font-size: 0.8rem;
          /* Ensure counter is always visible above mobile UI */
          z-index: 1002;
        }

        .slide-title {
          top: 3rem;
          max-width: 90%;
          /* Ensure slide content is visible above mobile UI */
          z-index: 1001;
        }

        .slide-tags {
          bottom: 3rem;
          max-width: 90%;
          /* Ensure slide content is visible above mobile UI */
          z-index: 1001;
        }

        .back-button {
          /* Ensure back button is always accessible */
          z-index: 1003;
        }
      }

      /* Fallback for browsers that don't support dvh */
      @supports not (height: 100dvh) {
        .slider {
          height: 100vh;
        }
      }
    </style>
  </head>
  <body>
    <div class="navigation-bar">
      <div class="nav-arrow nav-arrow-left">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15,18 9,12 15,6"></polyline>
        </svg>
      </div>
      <div class="nav-thumbnails" id="thumbnailContainer">
        <!-- Thumbnails will be dynamically generated -->
      </div>
      <div class="nav-arrow nav-arrow-right">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9,18 15,12 9,6"></polyline>
        </svg>
      </div>
    </div>

    <!-- Back to Commercial Button -->
    <a href="#" id="backToCommercial" class="back-button">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15,18 9,12 15,6"></polyline>
      </svg>
      <span>Back to Commercial</span>
    </a>

    <!-- Image Counter -->
    <div class="image-counter" id="imageCounter">
        Image 1 of 86
    </div>

    <div class="slider">
      <div class="slide">
        <div class="slide-img">
          <img src="/Mesa/1.webp" alt="" loading="lazy" decoding="async" />
        </div>

        <div class="slide-title">
          <h1>Mesa Main Street Stations</h1>
        </div>
        
        <div class="slide-tags">
          <p>Retail Areas</p>
          <p>2024</p>
          <p>Office Spaces</p>
        </div>
      </div>
    </div>

    <script>
      // Build slides dynamically from /Mesa/ with natural numeric ordering
      let slides = [];

      function naturalCompare(a, b) {
        // Robust numeric natural order: 1.webp, 1-1.webp, 2.webp, 2-1.webp, 12-10.webp, ...
        const toKey = (name) => name
          .replace(/\.webp$/i, '')
          .split(/[^0-9]+/) // split on non-digits to capture multi-part numbers
          .filter(Boolean)
          .map((n) => parseInt(n, 10));
        const ak = toKey(a);
        const bk = toKey(b);
        const len = Math.max(ak.length, bk.length);
        for (let i = 0; i < len; i++) {
          const av = ak[i] !== undefined ? ak[i] : -1; // base image comes before dashed variants
          const bv = bk[i] !== undefined ? bk[i] : -1;
          if (av !== bv) return av - bv;
        }
        return a.localeCompare(b);
      }

      function imageExists(url) {
        return new Promise((resolve) => {
          const img = new Image();
          img.onload = () => resolve(true);
          img.onerror = () => resolve(false);
          img.src = url;
        });
      }

      async function buildMesaSlides() {
        const candidates = new Set();
        // Numeric range likely present for Mesa
        for (let i = 1; i <= 120; i++) candidates.add(`${i}.webp`);
        // Common dashed variants encountered in Mesa set - expanded to cover all found images
        const series = [1, 9, 10, 11, 12, 15, 17, 18, 20, 23, 24, 25, 26, 27, 28, 39, 54, 70];
        const maxDash = { 1: 1, 9: 5, 10: 3, 11: 7, 12: 10, 15: 5, 17: 7, 18: 1, 20: 1, 23: 1, 24: 2, 25: 6, 26: 5, 27: 1, 28: 2, 39: 3, 54: 1, 70: 1 };
        series.forEach((base) => {
          const limit = maxDash[base] || 0;
          for (let n = 1; n <= limit; n++) candidates.add(`${base}-${n}.webp`);
        });

        const present = [];
        const checks = [];
        candidates.forEach((name) => {
          const url = `/Mesa/${name}`;
          checks.push(imageExists(url).then((ok) => { if (ok) present.push(name); }));
        });
        await Promise.all(checks);

        present.sort(naturalCompare);
        slides = present.map((image, index) => ({
          slideTitle: `Mesa Main Street Stations - Image ${index + 1}`,
          slideDescription: `Documentation of the Mesa Main Street Stations development project, showcasing the construction and design process.`,
          slideImg: `/Mesa/${image}`,
        }));
      }

      document.addEventListener("DOMContentLoaded", async () => {
        // Set back button link based on device type
        const backButton = document.getElementById('backToCommercial');
        const isMobile = window.innerWidth <= 1000 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        if (backButton) {
          backButton.href = isMobile ? 'commercial-mobile.html' : 'commercial.html';
        }
        
        await buildMesaSlides();
        // Better mobile viewport handling for address bar
        if (window.innerHeight < 800) { // Mobile device
          // Use a more reliable method to handle mobile viewport
          const setViewportHeight = () => {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
          };
          
          setViewportHeight();
          window.addEventListener('resize', setViewportHeight);
          window.addEventListener('orientationchange', () => {
            setTimeout(setViewportHeight, 100);
          });
        }

        const totalSlides = slides.length;
        let currentSlide = 1;
        let currentPage = 0; // Current page of thumbnails (0-4)
        const slidesPerPage = 5;

        let isAnimating = false;
        let scrollAllowed = true;
        let lastScrollTime = 0;

        const thumbnailContainer = document.getElementById('thumbnailContainer');
        const leftArrow = document.querySelector('.nav-arrow-left');
        const rightArrow = document.querySelector('.nav-arrow-right');

        function generateThumbnails() {
          thumbnailContainer.innerHTML = '';
          const startIndex = currentPage * slidesPerPage;
          const endIndex = Math.min(startIndex + slidesPerPage, totalSlides);

          for (let i = startIndex; i < endIndex; i++) {
            const thumbnail = document.createElement('div');
            thumbnail.className = 'thumbnail';
            thumbnail.setAttribute('data-slide', i + 1);

            const img = document.createElement('img');
            img.src = slides[i].slideImg;
            img.alt = slides[i].slideTitle;
            img.loading = 'lazy';
            img.decoding = 'async';
            thumbnail.appendChild(img);

            thumbnailContainer.appendChild(thumbnail);
          }
        }

        function updateNavigation() {
          const thumbnails = document.querySelectorAll('.thumbnail');
          thumbnails.forEach((thumb) => {
            const slideIndex = parseInt(thumb.getAttribute('data-slide'));
            thumb.classList.toggle('active', slideIndex === currentSlide);
          });
        }

        function updateImageCounter() {
          const imageCounter = document.getElementById('imageCounter');
          imageCounter.textContent = `Image ${currentSlide} of ${totalSlides}`;
        }

        function updateCurrentPage() {
          currentPage = Math.floor((currentSlide - 1) / slidesPerPage);
        }

        function createSlide(slideNumber) {
          const slide = document.createElement("div");
          slide.className = "slide";

          const slideData = slides[slideNumber - 1];

          slide.innerHTML = `
            <div class="slide-img">
              <img src="${slideData.slideImg}" alt="" loading="lazy" decoding="async" />
            </div>

            <div class="slide-title">
              <h1>${slideData.slideTitle}</h1>
            </div>
            
            <div class="slide-tags">
              <p>Retail Areas</p>
              <p>2024</p>
              <p>Office Spaces</p>
            </div>
          `;

          return slide;
        }

        function splitText(slide) {
          const title = slide.querySelector("h1");
          const description = slide.querySelector("p");

          if (title) {
            const titleText = title.textContent;
            title.innerHTML = titleText
              .split(" ")
              .map((word) => `<span class="word">${word}</span>`)
              .join(" ");
          }

          if (description) {
            const descText = description.textContent;
            description.innerHTML = descText
              .split(" ")
              .map((word) => `<span class="word">${word}</span>`)
              .join(" ");
          }
        }

        function animateSlide(direction) {
          if (isAnimating || !scrollAllowed) return;
          if (Date.now() - lastScrollTime < 150) return;

          isAnimating = true;
          scrollAllowed = false;

          const slider = document.querySelector(".slider");
          const currentSlideElement = slider.querySelector(".slide");

          const exitY = direction === "down" ? "-200vh" : "200vh";
          const entryY = direction === "down" ? "100vh" : "-100vh";
          const entryClipPath =
            direction === "down"
              ? "polygon(20% 20%, 80% 20%, 80% 100%, 20% 100%)"
              : "polygon(20% 0%, 80% 0%, 80% 80%, 20% 80%)";

          currentSlideElement.style.transform = `scale(0.25) translateY(${exitY}) rotate(30deg)`;
          currentSlideElement.style.transition = "all 0.5s ease-in-out";
          currentSlideElement.style.opacity = "0";

          setTimeout(() => {
            currentSlideElement.remove();

            if (direction === "down") {
              currentSlide = currentSlide === totalSlides ? 1 : currentSlide + 1;
            } else {
              currentSlide = currentSlide === 1 ? totalSlides : currentSlide - 1;
            }

            const newSlide = createSlide(currentSlide);

            newSlide.style.transform = `translateY(${entryY})`;
            newSlide.style.clipPath = entryClipPath;
            newSlide.style.transition = "all 0.4s ease-out";

            slider.appendChild(newSlide);

            splitText(newSlide);

            const words = newSlide.querySelectorAll(".word");

            words.forEach((word) => {
              word.style.transform = "translateY(100%)";
              word.style.transition = "transform 0.3s ease-out";
            });

            setTimeout(() => {
              newSlide.style.transform = "translateY(0)";
              newSlide.style.clipPath = "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)";

              setTimeout(() => {
                words.forEach((word, index) => {
                  setTimeout(() => {
                    word.style.transform = "translateY(0)";
                  }, index * 30);
                });
                
                // Re-trigger slide-tags animations
                const slideTags = newSlide.querySelectorAll(".slide-tags p");
                slideTags.forEach((tag) => {
                  tag.style.animation = "none";
                  setTimeout(() => {
                    tag.style.animation = "";
                  }, 10);
                });
              }, 200);
            }, 50);

            setTimeout(() => {
              isAnimating = false;
              updateCurrentPage();
              generateThumbnails();
              updateNavigation();
              updateImageCounter();
              setTimeout(() => {
                scrollAllowed = true;
                lastScrollTime = Date.now();
              }, 10);
            }, 400);
          }, 500);
        }

        // Function to jump directly to a specific slide with same animation as original
        function jumpToSlide(targetSlide) {
          if (isAnimating || !scrollAllowed) return;
          if (targetSlide === currentSlide) return;

          isAnimating = true;
          scrollAllowed = false;

          const slider = document.querySelector(".slider");
          const currentSlideElement = slider.querySelector(".slide");

          const direction = targetSlide > currentSlide ? "down" : "up";
          const exitY = direction === "down" ? "-200vh" : "200vh";
          const entryY = direction === "down" ? "100vh" : "-100vh";
          const entryClipPath =
            direction === "down"
              ? "polygon(20% 20%, 80% 20%, 80% 100%, 20% 100%)"
              : "polygon(20% 0%, 80% 0%, 80% 80%, 20% 80%)";

          currentSlideElement.style.transform = `scale(0.25) translateY(${exitY}) rotate(30deg)`;
          currentSlideElement.style.transition = "all 0.5s ease-in-out";
          currentSlideElement.style.opacity = "0";

          setTimeout(() => {
            currentSlideElement.remove();
            currentSlide = targetSlide;
            const newSlide = createSlide(currentSlide);

            newSlide.style.transform = `translateY(${entryY})`;
            newSlide.style.clipPath = entryClipPath;
            newSlide.style.transition = "all 0.4s ease-out";

            slider.appendChild(newSlide);

            splitText(newSlide);

            const words = newSlide.querySelectorAll(".word");

            words.forEach((word) => {
              word.style.transform = "translateY(100%)";
              word.style.transition = "transform 0.3s ease-out";
            });

            setTimeout(() => {
              newSlide.style.transform = "translateY(0)";
              newSlide.style.clipPath = "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)";

              setTimeout(() => {
                words.forEach((word, index) => {
                  setTimeout(() => {
                    word.style.transform = "translateY(0)";
                  }, index * 30);
                });
                
                // Re-trigger slide-tags animations
                const slideTags = newSlide.querySelectorAll(".slide-tags p");
                slideTags.forEach((tag) => {
                  tag.style.animation = "none";
                  setTimeout(() => {
                    tag.style.animation = "";
                  }, 10);
                });
              }, 200);
            }, 50);

            setTimeout(() => {
              isAnimating = false;
              updateCurrentPage();
              generateThumbnails();
              updateNavigation();
              updateImageCounter();
              setTimeout(() => {
                scrollAllowed = true;
                lastScrollTime = Date.now();
              }, 10);
            }, 400);
          }, 500);
        }

        // Thumbnail click handler
        thumbnailContainer.addEventListener('click', (e) => {
          const thumbnail = e.target.closest('.thumbnail');
          if (thumbnail) {
            const targetSlide = parseInt(thumbnail.getAttribute('data-slide'));
            jumpToSlide(targetSlide);
          }
        });

        // Arrow navigation
        leftArrow.addEventListener('click', () => {
          if (isAnimating || !scrollAllowed) return;

          // Go to first image of previous 5
          let newSlide = Math.floor((currentSlide - 1) / slidesPerPage) * slidesPerPage;
          if (newSlide < 1) {
            // If we go below 1, wrap to the last page
            newSlide = Math.floor((totalSlides - 1) / slidesPerPage) * slidesPerPage + 1;
          }
          
          const newPage = Math.floor((newSlide - 1) / slidesPerPage);
          if (newPage !== currentPage) {
            currentPage = newPage;
            generateThumbnails();
          }
          
          jumpToSlide(newSlide);
        });

        rightArrow.addEventListener('click', () => {
          if (isAnimating || !scrollAllowed) return;

          // Go to first image of next 5
          let newSlide = Math.floor((currentSlide - 1) / slidesPerPage) * slidesPerPage + slidesPerPage + 1;
          if (newSlide > totalSlides) {
            // If we go above total, wrap to the beginning
            newSlide = 1;
          }
          
          const newPage = Math.floor((newSlide - 1) / slidesPerPage);
          if (newPage !== currentPage) {
            currentPage = newPage;
            generateThumbnails();
          }
          
          jumpToSlide(newSlide);
        });

        // Mouse wheel navigation with throttling
        let wheelTimeout;
        window.addEventListener("wheel", (e) => {
          if (isAnimating || !scrollAllowed) return;
          if (Date.now() - lastScrollTime < 150) return;

          // Throttle wheel events for smoother performance
          clearTimeout(wheelTimeout);
          wheelTimeout = setTimeout(() => {
            const direction = e.deltaY > 0 ? "down" : "up";
            animateSlide(direction);
          }, 16); // ~60fps throttling
        }, { passive: true });

        // Touch navigation with improved sensitivity
        let touchStartY = 0;
        let touchStartTime = 0;
        let touchMoved = false;

        window.addEventListener("touchstart", (e) => {
          touchStartY = e.touches[0].clientY;
          touchStartTime = Date.now();
          touchMoved = false;
        }, { passive: true });

        window.addEventListener("touchmove", (e) => {
          touchMoved = true;
        }, { passive: true });

        window.addEventListener("touchend", (e) => {
          if (isAnimating || !scrollAllowed || !touchMoved) return;
          if (Date.now() - lastScrollTime < 120) return;

          const touchEndY = e.changedTouches[0].clientY;
          const touchEndTime = Date.now();
          const deltaY = touchStartY - touchEndY;
          const deltaTime = touchEndTime - touchStartTime;

          // Improved touch sensitivity
          if (Math.abs(deltaY) > 40 && deltaTime < 400) {
            const direction = deltaY > 0 ? "down" : "up";
            animateSlide(direction);
          }
        }, { passive: true });

        // Mobile viewport handling - no more problematic scroll-based address bar hiding

        // Initialize the gallery
        generateThumbnails();
        updateNavigation();
        updateImageCounter();
      });
    </script>
  </body>
</html>